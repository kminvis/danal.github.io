<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>다날 휴대폰 정기결제</title>
    <script src="https://cdn.iamport.kr/js/iamport.payment-1.1.8.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" type="text/css" href="common.css">
</head>

<body>
    <section class="header-section">
        <div class="ext-join-common" style="display: block;"> 환급금 <span>이동통신사 유료부가서비스</span>
            <div class="divider"></div>
        </div>
    </section>
    <div id="content" class="content-container">
        <div class="ext-join-common" style="display: block;">
            <div class="detail"> <img
                    src="https://d378edkbm4mh9y.cloudfront.net/static/images/common/ico_ext_join_top_msg.png"
                    data-name="ico_ext_join_top_msg" alt="정부지원금 및 동네 생활정보 찾기 서비스"> </div>
            <div class="service-intro">
                <div class="ico-list-container">
                    <div class="ico-list">
                        <div class="ico"><img
                                src="https://d378edkbm4mh9y.cloudfront.net/static/images/common/ico_ext_join_svc_intro1.svg"
                                data-name="ico_ext_join_svc_intro1" alt="정책 지원금 확인하기"></div>
                        <div class="ico"><img
                                src="https://d378edkbm4mh9y.cloudfront.net/static/images/common/ico_ext_join_svc_intro2.svg"
                                data-name="ico_ext_join_svc_intro2" alt="물가 확인하고 장보기"></div>
                        <div class="ico"><img
                                src="https://d378edkbm4mh9y.cloudfront.net/static/images/common/ico_ext_join_svc_intro3.svg"
                                data-name="ico_ext_join_svc_intro3" alt="안전지수 확인하고 사고 위험 대비"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="auth-container">
        <div class="price-notice"> 매월 부가세 포함 3,300원<br><span>본 서비스는 이용료가 통신요금에 포함되어 부과됩니다. </span> </div>
    </div>
    <section class="footer-section" style="display: block;">
        <div class="ext-join-common" style="display: block;">
            <div class="terms-info">
                <h5>서비스 이용약관</h5>
                <div class="terms-divider"></div>
                <h3>개인정보 처리방침
                </h3>
            </div>
            <h3>서비스 안내</h3>
            <h5>본 서비스는 전용 페이지에서 이용 가능합니다.</h5>
            <h5>
                <ul>
                    <li>가입/해지: 0000-0000(평일 10시~17시)</li>
                    <li>서비스 해지 시 이용 요금은 사용일 수만큼 일할 계산되어 과금됩니다.</li>
                    <li>환불: 공정거래위원회 소비자분쟁해결기준에 의거하여 분쟁 해결 및 이용 요금 환불 처리를 진행합니다. 환불 신청 및 계약 해지와 환불 신청에 대한 결과 확인은 고객센터를 통해 확인 가능합니다.</li>
                    <li>선불요금제, 사물통신/모뎀요금제 사용자, 법인 및 미성년자는 서비스 가입 및 이용이 불가능합니다.</li>
                </ul>
            </h5>
        </div>
        <div class="company-info">
            <h3>(주) </h3>
            <div class="detail">
                <h5>대표: </h5>
                <h5>서울 </h5>
                <h5>사업자등록번호: </h5>
                <h5>고객센터: </a> (평일 10시-17시, 점심시간 제외)</h5>
                <h5 style="margin-bottom:12px">이메일: </h5>
                <h5>Ⓒ 2024. . All rights reserved.</h5>
            </div>
        </div>
    </section>
    <script>
        var IMP = window.IMP;
        IMP.init('imp10818454'); // 아임포트 가맹점 식별코드 입력

        // merchant_uid를 '날짜 + 랜덤값'으로 생성하는 함수
        function generateMerchantUid() {
            var date = new Date().toISOString().slice(0, 10).replace(/-/g, ''); // 날짜 (YYYYMMDD 형식)
            var random = Math.floor(Math.random() * 1000000); // 랜덤 6자리 숫자
            return 'order_' + date + '_' + random; // 예: order_20231020_123456
        }

        // customer_uid를 '랜덤값'으로 생성하는 함수
        function generateCustomerUid() {
            var random = Math.floor(Math.random() * 1000000); // 랜덤 6자리 숫자
            return 'customer_' + random; // 예: customer_123456
        }

        // 페이지가 로드되면 결제 요청
        document.addEventListener('DOMContentLoaded', function () {
            var merchantUid = generateMerchantUid(); // 주문 번호 생성
            var customerUid = generateCustomerUid(); // 고객 고유 ID 생성

            IMP.request_pay({
                pg: 'danal', // 다날 PG사 설정
                pay_method: 'phone', // 휴대폰 결제 방식
                merchant_uid: merchantUid, // 주문 번호 (랜덤 값)
                name: '환급금 조회', // 결제명
                amount: 3300, // 결제 금액
                customer_uid: customerUid // 고객 고유 ID (랜덤 값)
            }, function (rsp) {
                if (rsp.success) {
                    alert('결제 성공');
                    console.log('응답:', rsp);
                    // 서버로 billing key 발급 성공 정보 전달
                } else {
                    alert('결제 실패: ' + rsp.error_msg);
                    console.log('실패 이유:', rsp);
                }
            });
        });
    </script>
</body>

</html>
